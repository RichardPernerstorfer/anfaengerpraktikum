library(readr)


##  Divi Datensatz


rki_data <- read_csv("RKI_COVID19.csv")
rki_data_inzidenz <- rki_data[,c(2,7,9)]
### Inzidenzen

Einwohner <- c(2896712,1841179,7982448,682986,17932651,6265809,4084844,11069533,13076721,990509,3644826,2511917,1609675,4077937,2208321,2143145)
Datum <- unique(rki_data_inzidenz$Meldedatum)
dates <- c()
bundeslaender <- c()
inzidenz <- c()
for(i in 1:length(Datum)){
  for(j in 1:16){
    bl <- as.character(j)
    
    a <- subset(rki_data_inzidenz, Meldedatum == Datum[i])
    b <- subset(a, IdBundesland == bl)
    c <- (sum(b$AnzahlFall)/Einwohner[j]) *100000
    
    dates <- c(dates,paste(Datum[i]))
    bundeslaender <- c(bundeslaender,bl)
    inzidenz <- c(inzidenz,c)
    
  }
}

inzidenz_bundeslaender <- cbind(dates, bundeslaender,inzidenz)
inzidenz_bundeslaender <- as.data.frame(inzidenz_bundeslaender)

inzidenz_bundeslaender <- inzidenz_bundeslaender[order( inzidenz_bundeslaender[,2] ),]
inzidenz_bundeslaender[,1] <- as.Date(inzidenz_bundeslaender[,1], "%Y-%m-%d")
inzidenz_bundeslaender[,3] <- as.numeric(inzidenz_bundeslaender[,3])
